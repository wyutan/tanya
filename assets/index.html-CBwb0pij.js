import{_ as e,c as a,a as i,o as n}from"./app-DMcXO7hu.js";const l={};function d(r,s){return n(),a("div",null,[...s[0]||(s[0]=[i(`<div class="hint-container tip"><p class="hint-container-title">提示</p><p>在线部署时可不修改镜像地址</p></div><h2 id="环境准备" tabindex="-1"><a class="header-anchor" href="#环境准备"><span>环境准备</span></a></h2><p><mark>先决条件</mark></p><h3 id="关闭防火墙、swap分区、selinux" tabindex="-1"><a class="header-anchor" href="#关闭防火墙、swap分区、selinux"><span>关闭防火墙、swap分区、selinux</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>systemctl disable firewalld --now</span></span>
<span class="line"><span>swapoff -a</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>sed -ri &#39;/^[^#]*swap/s@^@#@&#39; /etc/fstab</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>setenforce 0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>sed -i &#39;s/^SELINUX=enforcing$/SELINUX=permissive/&#39; /etc/selinux/config</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="修改所有master、node节点hosts文件-配置时钟同步" tabindex="-1"><a class="header-anchor" href="#修改所有master、node节点hosts文件-配置时钟同步"><span>修改所有master、node节点hosts文件，配置时钟同步</span></a></h3><h3 id="为了确保在使用-kubernetes-中的网络插件时-网络流量可以正确地通过-iptables-进行处理。" tabindex="-1"><a class="header-anchor" href="#为了确保在使用-kubernetes-中的网络插件时-网络流量可以正确地通过-iptables-进行处理。"><span>为了确保在使用 Kubernetes 中的网络插件时，网络流量可以正确地通过 iptables 进行处理。</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>cat &lt;&lt;EOF &gt; /etc/sysctl.d/k8s.conf</span></span>
<span class="line"><span>net.ipv4.ip_forward = 1</span></span>
<span class="line"><span>net.bridge.bridge-nf-call-iptables = 1</span></span>
<span class="line"><span>net.bridge.bridge-nf-call-ip6tables = 1</span></span>
<span class="line"><span>EOF</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>sysctl --system</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="安装docker" tabindex="-1"><a class="header-anchor" href="#安装docker"><span>安装docker</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>yum remove docker \\</span></span>
<span class="line"><span>                  docker-client \\</span></span>
<span class="line"><span>                  docker-client-latest \\</span></span>
<span class="line"><span>                  docker-common \\</span></span>
<span class="line"><span>                  docker-latest \\</span></span>
<span class="line"><span>                  docker-latest-logrotate \\</span></span>
<span class="line"><span>                  docker-logrotate \\</span></span>
<span class="line"><span>                  docker-engine</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>yum install -y yum-utils</span></span>
<span class="line"><span>yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span></span>
<span class="line"><span>yum install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin</span></span>
<span class="line"><span>systemctl enable docker.service --now</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="修改docker-cgroup参数" tabindex="-1"><a class="header-anchor" href="#修改docker-cgroup参数"><span>修改docker cgroup参数</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>vim /etc/docker/daemon.json</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>{</span></span>
<span class="line"><span>  &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;]</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>systemctl daemon-reload</span></span>
<span class="line"><span>systemctl restart docker</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="离线安装cri-docker" tabindex="-1"><a class="header-anchor" href="#离线安装cri-docker"><span>离线安装cri-docker</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>rpm -ivh cri-dockerd-0.3.11-3.el7.x86_64.rpm</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="修改cri镜像仓库" tabindex="-1"><a class="header-anchor" href="#修改cri镜像仓库"><span>修改cri镜像仓库</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>vim /usr/lib/systemd/system/cri-docker.service</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>fd:// --pod-infra-container-image=x.x.x.x/xxx/pause:xx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><mark>安装并初始化k8s</mark></p><h3 id="安装组件kubeadm-kubelet-and-kubectl" tabindex="-1"><a class="header-anchor" href="#安装组件kubeadm-kubelet-and-kubectl"><span>安装组件kubeadm, kubelet and kubectl</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>cat &lt;&lt;EOF | sudo tee /etc/yum.repos.d/kubernetes.repo</span></span>
<span class="line"><span>[kubernetes]</span></span>
<span class="line"><span>name=Kubernetes</span></span>
<span class="line"><span>baseurl=https://pkgs.k8s.io/core:/stable:/v1.29/rpm/</span></span>
<span class="line"><span>enabled=1</span></span>
<span class="line"><span>gpgcheck=1</span></span>
<span class="line"><span>gpgkey=https://pkgs.k8s.io/core:/stable:/v1.29/rpm/repodata/repomd.xml.key</span></span>
<span class="line"><span>exclude=kubelet kubeadm kubectl cri-tools kubernetes-cni</span></span>
<span class="line"><span>EOF</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>yum install -y kubelet kubeadm kubectl --disableexcludes=kubernetes</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="设置kubelet开机启动" tabindex="-1"><a class="header-anchor" href="#设置kubelet开机启动"><span>设置kubelet开机启动</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>systemctl enable kubelet --now</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="保存并修改配置文件" tabindex="-1"><a class="header-anchor" href="#保存并修改配置文件"><span>保存并修改配置文件</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>kubeadm config print init-defaults &gt; k8s.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>vim k8s.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>kind:localAPIEndpoint:advertiseAddress: x.x.x.x  //master ip</span></span>
<span class="line"><span>nodeRegistration:criSocket: /var/run/cri-dockerd.sock</span></span>
<span class="line"><span>kubernetesVersion: x:x:x  //若离线安装，此处版本与安装包保持一致</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="初始化文件" tabindex="-1"><a class="header-anchor" href="#初始化文件"><span>初始化文件</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>apiVersion: kubeadm.k8s.io/v1beta3</span></span>
<span class="line"><span>kind: InitConfiguration</span></span>
<span class="line"><span>#localAPIEndpoint:</span></span>
<span class="line"><span>#  advertiseAddress: x.x.x.11</span><span>    //宿主机IP，非虚IP</span></span>
<span class="line"><span>#  bindPort: 16443</span></span>
<span class="line"><span>nodeRegistration:</span></span>
<span class="line"><span>  criSocket: unix:///var//run/cri-dockerd.sock</span></span>
<span class="line"><span>  imagePullPolicy: IfNotPresent</span></span>
<span class="line"><span>  name: k8s-master01                //node名</span></span>
<span class="line"><span>  taints: null</span></span>
<span class="line"><span>---</span></span>
<span class="line"><span>apiServer:</span></span>
<span class="line"><span>  certSANs:</span></span>
<span class="line"><span>  - api.k8s.local</span></span>
<span class="line"><span>  - k8s-master01</span></span>
<span class="line"><span>  - k8s-master02</span></span>
<span class="line"><span>  - k8s-master03</span></span>
<span class="line"><span>  - x.x.x.11</span></span>
<span class="line"><span>  - x.x.x.12</span></span>
<span class="line"><span>  - x.x.x.10</span></span>
<span class="line"><span>  - x.x.x.9</span></span>
<span class="line"><span>  extraArgs:</span></span>
<span class="line"><span>    authorization-mode: Node,RBAC</span></span>
<span class="line"><span>  timeoutForControlPlane: 4m0s</span></span>
<span class="line"><span>controlPlaneEndpoint: x.x.x.9:16443        //虚IP</span></span>
<span class="line"><span>apiVersion: kubeadm.k8s.io/v1beta3</span></span>
<span class="line"><span>certificatesDir: /etc/kubernetes/pki</span></span>
<span class="line"><span>clusterName: kubernetes</span></span>
<span class="line"><span>controllerManager: {}</span></span>
<span class="line"><span>dns: {}</span></span>
<span class="line"><span>etcd:</span></span>
<span class="line"><span>  local:</span></span>
<span class="line"><span>    dataDir: /var/lib/etcd</span></span>
<span class="line"><span>imageRepository: x.x.x.x:5000/containers</span></span>
<span class="line"><span>kind: ClusterConfiguration</span></span>
<span class="line"><span>kubernetesVersion: 1.29.3</span></span>
<span class="line"><span>networking:</span></span>
<span class="line"><span>  dnsDomain: cluster.local</span></span>
<span class="line"><span>  podSubnet: 192.168.0.0/16</span></span>
<span class="line"><span>  serviceSubnet: 172.16.0.0/16</span></span>
<span class="line"><span>scheduler: {}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="初始化k8s集群" tabindex="-1"><a class="header-anchor" href="#初始化k8s集群"><span>初始化k8s集群</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>kubeadm init --config k8s.yaml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><mark>初始化成功后回显如下</mark></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>  mkdir -p $HOME/.kube</span></span>
<span class="line"><span>  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</span></span>
<span class="line"><span>  sudo chown $(id -u):$(id -g) $HOME/.kube/config</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Alternatively, if you are the root user, you can run:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  export KUBECONFIG=/etc/kubernetes/admin.conf</span></span>
<span class="line"><span></span></span>
<span class="line"><span>You should now deploy a pod network to the cluster.</span></span>
<span class="line"><span>Run &quot;kubectl apply -f [podnetwork].yaml&quot; with one of the options listed at:</span></span>
<span class="line"><span>  https://kubernetes.io/docs/concepts/cluster-administration/addons/</span></span>
<span class="line"><span></span></span>
<span class="line"><span>You can now join any number of control-plane nodes by copying certificate authorities</span></span>
<span class="line"><span>and service account keys on each node and then running the following as root:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  kubeadm join x.x.x.9:16443 --token abcdef.0123456789abcdef \\</span></span>
<span class="line"><span>        --discovery-token-ca-cert-hash sha256:ba257ca734abaaf8737bd0fcecc9b9d1f1 \\</span></span>
<span class="line"><span>        --control-plane </span></span>
<span class="line"><span></span></span>
<span class="line"><span>Then you can join any number of worker nodes by running the following on each as root:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>kubeadm join x.x.x.9:16443 --token abcdef.0123456789abcdef \\</span></span>
<span class="line"><span>        --discovery-token-ca-cert-hash sha256:ba257ca734abaaf8737bd0fcecc9b9d1f1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="安装网络插件" tabindex="-1"><a class="header-anchor" href="#安装网络插件"><span>安装网络插件</span></a></h3><h3 id="添加master节点" tabindex="-1"><a class="header-anchor" href="#添加master节点"><span>添加master节点</span></a></h3><ul><li>获取证书密钥</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>kubeadm init phase upload-certs --upload-certs</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><mark>回显如下</mark></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>[upload-certs] Using certificate key:</span></span>
<span class="line"><span>f26261f40c5cfe059bf14f394771b1c50996f79</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>在其他master节点输入</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>kubeadm join x.x.x.9:16443 --token abcdef.0123456789abcdef \\</span></span>
<span class="line"><span>        --discovery-token-ca-cert-hash sha256:ba257ca734abaaf8737bd0fcecc9b9d1f1 \\</span></span>
<span class="line"><span>        --control-plane --certificate-key f26261f40c5cfe059bf14f394771b1c50996f79 \\</span></span>
<span class="line"><span>        --criSocket: unix:///var//run/cri-dockerd.sock</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="添加work节点" tabindex="-1"><a class="header-anchor" href="#添加work节点"><span>添加work节点</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>kubeadm join x.x.x.9:16443 --token abcdef.0123456789abcdef \\</span></span>
<span class="line"><span>        --discovery-token-ca-cert-hash sha256:ba257ca734abaaf8737bd0fcecc9b9d1f1 \\</span></span>
<span class="line"><span>        --criSocket: unix:///var//run/cri-dockerd.sock</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,50)])])}const c=e(l,[["render",d]]),p=JSON.parse('{"path":"/%E5%AE%B9%E5%99%A8/r1roozlr/","title":"k8s安装","lang":"zh-CN","frontmatter":{"title":"k8s安装","createTime":"2025/09/11 13:11:28","permalink":"/容器/r1roozlr/","description":"提示 在线部署时可不修改镜像地址 环境准备 先决条件 关闭防火墙、swap分区、selinux 修改所有master、node节点hosts文件，配置时钟同步 为了确保在使用 Kubernetes 中的网络插件时，网络流量可以正确地通过 iptables 进行处理。 安装docker 修改docker cgroup参数 离线安装cri-docker 修...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"k8s安装\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-05-28T08:01:21.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"http://git.x-echo.net/%E5%AE%B9%E5%99%A8/r1roozlr/"}],["meta",{"property":"og:site_name","content":"谈呀"}],["meta",{"property":"og:title","content":"k8s安装"}],["meta",{"property":"og:description","content":"提示 在线部署时可不修改镜像地址 环境准备 先决条件 关闭防火墙、swap分区、selinux 修改所有master、node节点hosts文件，配置时钟同步 为了确保在使用 Kubernetes 中的网络插件时，网络流量可以正确地通过 iptables 进行处理。 安装docker 修改docker cgroup参数 离线安装cri-docker 修..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-05-28T08:01:21.000Z"}],["meta",{"property":"article:modified_time","content":"2025-05-28T08:01:21.000Z"}]]},"readingTime":{"minutes":2.25,"words":675},"git":{"createdTime":1741316579000,"updatedTime":1748419281000,"contributors":[{"name":"wyutan","username":"wyutan","email":"90786339+wyutan@users.noreply.github.com","commits":21,"avatar":"https://avatars.githubusercontent.com/wyutan?v=4","url":"https://github.com/wyutan"}],"changelog":[{"hash":"7b12623eba6af934f32bd1fc81af6c3745ae7c2e","time":1748419281000,"email":"90786339+wyutan@users.noreply.github.com","author":"wyutan","message":"Update 2.k8s安装.md"},{"hash":"d44b15f5eba500903a266ef58aa50cb11538740f","time":1745475551000,"email":"90786339+wyutan@users.noreply.github.com","author":"wyutan","message":"Update 2.k8s安装.md"},{"hash":"187ae9ef8564e73530567e6eb767ac588a2c421f","time":1745475019000,"email":"90786339+wyutan@users.noreply.github.com","author":"wyutan","message":"更新 2.k8s安装.md"},{"hash":"f6dfb6875b081ebe780dd6748a2591bbe4a998be","time":1745474505000,"email":"90786339+wyutan@users.noreply.github.com","author":"wyutan","message":"Update 2.k8s安装.md"},{"hash":"3e17f835f9d61fa243a046e6404561c20ac9dd9f","time":1742191186000,"email":"90786339+wyutan@users.noreply.github.com","author":"wyutan","message":"Update 2.k8s安装.md"},{"hash":"ab3ba3ecc98dcdd274751126c9765354531a9cde","time":1742185224000,"email":"90786339+wyutan@users.noreply.github.com","author":"wyutan","message":"Update 2.k8s安装.md"},{"hash":"344b030dfa4ce10cfdf5f8cf729ce9b1a6aa2f6a","time":1741959019000,"email":"90786339+wyutan@users.noreply.github.com","author":"wyutan","message":"更新 2.k8s安装.md"},{"hash":"4911eb382ddd38a32997cac197926a6bf65efc29","time":1741958308000,"email":"90786339+wyutan@users.noreply.github.com","author":"wyutan","message":"更新 2.k8s安装.md"},{"hash":"890a5f452745505c605f8b09ae00dd830b029f09","time":1741947358000,"email":"90786339+wyutan@users.noreply.github.com","author":"wyutan","message":"更新 2.k8s安装.md"},{"hash":"137475454b9b03d7c529c0cddc2e24d5536bf214","time":1741942891000,"email":"90786339+wyutan@users.noreply.github.com","author":"wyutan","message":"更新 2.k8s安装.md"}]},"autoDesc":true,"filePathRelative":"容器/k8s/note/2.k8s安装.md","headers":[],"categoryList":[{"id":"22c799","sort":10000,"name":"容器"},{"id":"eb26bc","sort":10001,"name":"k8s"},{"id":"74a94d","sort":10003,"name":"note"}]}');export{c as comp,p as data};
