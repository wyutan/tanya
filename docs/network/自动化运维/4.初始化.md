## excel文件
| 设备esn | 交换机上所有vlan | 下联口vlan | 管理vlan | 管理ip  | 掩码         | 缺省路由下一跳 | 用户名 | 密码 |
|---------|----------------|-----------|---------|---------|-------------|--------------|------|------|
| esn     | all_vlan       | vlanid    | mgmt_vlan | mgmt_ip | netmask     | gateway      |      |      |
| 111     | 121 131        | 131       | 131     | 10.1.1.2 | 255.255.255.0 | 10.1.1.1   |      |      |

## 代码
```py
import sys
import datetime
from pathlib import Path
from openpyxl import load_workbook

# 获取当前日期，并创建文件夹
current_date = datetime.datetime.now().strftime("%Y%m%d")
new_folder = Path(current_date)
new_folder.mkdir(exist_ok=True)
print(f"📂 使用文件夹: {new_folder}")

# 定义模板文件和 Excel 文件路径
template_file = Path("接入初始化.cfg")
info_file = Path("配置.xlsx")

# 确保模板和 Excel 文件存在
if not template_file.exists():
    print(f"❌ 模板文件 {template_file} 不存在！")
    input("按任意键退出...")
    sys.exit(1)

if not info_file.exists():
    print(f"❌ Excel 文件 {info_file} 不存在！")
    input("按任意键退出...")
    sys.exit(1)

# 加载 Excel 文件
wb = load_workbook(filename=info_file)
sheet = wb.active

# 读取模板内容，并去掉注释行
with template_file.open('r', encoding='utf-8') as template:
    template_content = ''.join(line for line in template if not line.strip().startswith('#'))

# 统计成功生成的文件数量
generated_files = 0

# 遍历 Excel 数据并生成文件
for row_index, row in enumerate(sheet.iter_rows(min_row=3, values_only=True), start=3):
    # 跳过整行为空的数据
    if all(cell is None for cell in row):
        print(f"⚠️ [警告] Excel 第 {row_index} 行为空，跳过...")
        continue

    # 检查缺失数据
    missing_info = []
    headers = ["设备 esn", "交换机上所有 vlan", "管理 vlan", "下联口 vlan", "管理 ip", "掩码", "缺省路由下一跳", "用户名", "密码"]
    for idx, cell in enumerate(row):
        if cell is None:
            missing_info.append(headers[idx])

    # 如果有缺失数据，打印错误并退出
    if missing_info:
        print(f"❌ [错误] Excel 第 {row_index} 行缺失数据: {', '.join(missing_info)}")
        input("按任意键退出...")
        sys.exit(1)

    # 解析数据
    esn, vlan_raw, vlanid, mgmt_vlan, mgmt_ip, netmask, gateway, username, passwd = row

    # 处理 VLAN ID
    if isinstance(vlan_raw, str):
        vlanid_list = [int(v.strip()) for v in vlan_raw.split() if v.strip().isdigit()]
    elif isinstance(vlan_raw, (int, float)):
        vlanid_list = [int(vlan_raw)]
    else:
        print(f"❌ Excel 第 {row_index} 行 VLAN ID 格式错误: {vlan_raw}")
        input("按任意键退出...")
        sys.exit(1)

    # 转换 VLAN ID 为字符串格式
    vlanid_str = ' '.join(map(str, vlanid_list))

    # 生成配置内容
    try:
        file_content = template_content.format(
            vlan_raw=vlanid_str, vlanid=vlanid, mgmt_vlan=mgmt_vlan,
            mgmt_ip=mgmt_ip, netmask=netmask, gateway=gateway, username=username, passwd=passwd
        )
    except KeyError as e:
        print(f"❌ Excel 第 {row_index} 行，模板变量缺失: {e}")
        input("按任意键退出...")
        sys.exit(1)

    # 生成文件
    file_path = new_folder / f"{esn}_{mgmt_ip}.cfg"
    with file_path.open('w', encoding='utf-8', errors='replace') as output_file:
        output_file.write(file_content)

    print(f"✅ 生成文件: {file_path}")
    generated_files += 1

# 输出成功信息
if generated_files > 0:
    print(f"🎉 脚本执行完成！共生成 {generated_files} 个配置文件。")
else:
    print("⚠️ 没有生成任何配置文件，请检查 Excel 数据是否完整。")

# 等待用户按任意键退出
input("✅ 任务完成，按任意键退出...")
