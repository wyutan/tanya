## excel文件

| VLAN ID | IP             | 掩码           | 路由下一跳    | 用户名  | 密码        |
|---------|--------------|--------------|------------|------|------------|
| 131     | 10.167.31.252 | 255.255.255.0 | 10.167.31.1 |  |  |

## 代码
```py
import datetime
from pathlib import Path
from openpyxl import load_workbook

# 获取当前日期，并创建对应文件夹
current_date = datetime.datetime.now().strftime("%Y%m%d")
new_folder = Path(current_date)
new_folder.mkdir(exist_ok=True)
print(f"使用文件夹 {new_folder}")

# 定义文件路径
template_file = Path("S57-48口初始化.cfg")
info_file = Path("配置.xlsx")

# 检查模板文件和 Excel 文件是否存在
if not template_file.exists():
    raise FileNotFoundError(f"模板文件 {template_file} 不存在！")
if not info_file.exists():
    raise FileNotFoundError(f"Excel 文件 {info_file} 不存在！")

# 加载 Excel 文件
wb = load_workbook(filename=info_file)
sheet = wb.active

# 读取模板文件内容，并去掉注释行
with template_file.open('r', encoding='utf-8') as template:
    template_content = ''.join(line for line in template if not line.strip().startswith('#'))

# 读取 Excel 数据，并生成配置文件
for row in sheet.iter_rows(min_row=2, values_only=True):
    if all(cell is None for cell in row):
        continue  # 跳过空行

    # 读取 Excel 数据（新增 esn）
    esn, vlanid, ip1, ip2, ip3, username, passwd = row

    # 处理数据格式，防止数值变成浮点数
    vlanid = int(vlanid) if isinstance(vlanid, (int, float)) else vlanid
    esn = str(esn).strip()  # 确保 esn 是字符串

    try:
        file_content = template_content.format(
            vlanid=vlanid, x=ip1, y=ip2, z=ip3, username=username, passwd=passwd
        )
    except KeyError as e:
        print(f"格式化失败，缺少变量: {e}")
        continue

    # 生成文件名：esn_ip1.cfg
    file_path = new_folder / f"{esn}_{ip1}.cfg"
    with file_path.open('w', encoding='utf-8', errors='replace') as output_file:
        output_file.write(file_content)

    print(f"生成文件 {file_path}")

print("脚本执行完成！")
