## excel文件

## 代码
```py
import datetime
from pathlib import Path
from openpyxl import load_workbook

# 获取当前日期，用于创建文件夹
current_date = datetime.datetime.now().strftime("%Y%m%d")
new_folder = Path(current_date)

# 创建以当前日期命名的文件夹（若不存在）
new_folder.mkdir(exist_ok=True)
print(f"使用文件夹 {new_folder}")

# 定义模板文件和信息文件路径
template_file = Path("S57-48口初始化.cfg")
info_file = Path("配置.xlsx")

# 检查模板文件和 Excel 文件是否存在
if not template_file.exists():
    raise FileNotFoundError(f"模板文件 {template_file} 不存在！")
if not info_file.exists():
    raise FileNotFoundError(f"Excel 文件 {info_file} 不存在！")

# 加载Excel文件
wb = load_workbook(filename=info_file)
sheet = wb.active

# 读取模板文件内容，并去掉注释行
with template_file.open('r', encoding='utf-8') as template:
    template_content = ''.join(line for line in template if not line.strip().startswith('#'))

# 获取Excel中的数据，并生成对应的文件
for row_index, row in enumerate(sheet.iter_rows(min_row=2, values_only=True), start=2):
    # 检查每一行的数据完整性，确保没有为空的字段
    if any(cell is None for cell in row):
        raise ValueError(f"❌ [错误] Excel 第 {row_index} 行数据缺失: {row}")
    
    esn, mgmt_vlan, vlanid_raw, ip1, ip2, ip3, username, passwd = row

    # **处理 VLAN ID（空格分隔）**
    if isinstance(vlanid_raw, str):
        vlanid_list = [int(v.strip()) for v in vlanid_raw.split() if v.strip().isdigit()]
    elif isinstance(vlanid_raw, (int, float)):
        vlanid_list = [int(vlanid_raw)]
    else:
        raise ValueError(f"❌ [错误] Excel 第 {row_index} 行 VLAN ID 格式错误: {vlanid_raw}")

    vlanid_str = ' '.join(map(str, vlanid_list))  # 生成字符串形式 "10 20 30"

    # 生成文件内容，不包括 esn
    try:
        file_content = template_content.format(
            mgmt_vlan=mgmt_vlan, vlanid=vlanid_str, ip1=ip1, ip2=ip2, ip3=ip3, 
            username=username, passwd=passwd
        )
    except KeyError as e:
        print(f"❌ [错误] 模板变量缺失: {e}")
        continue

    # 生成文件名：ESN_IP.cfg（ESN仅用于文件名）
    file_path = new_folder / f"{esn}_{ip1}.cfg"
    with file_path.open('w', encoding='utf-8', errors='replace') as output_file:
        output_file.write(file_content)

    print(f"✅ 生成文件 {file_path}")

print("🎉 脚本执行完成！")