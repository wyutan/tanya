## 选路逻辑小结

1. **数值越小越优**：这一点华为和思科完全一致。
2. **本地意义**：这些修改仅影响**本台设备**的路由表，不会传递给邻居。
3. **浮动路由策略**：在华为中做静态备份 OSPF 时，静态优先级必须调小（小于10）；在思科中做静态备份 OSPF 时，静态优先级需调大（大于110）。

## 不同厂商常见路由协议管理距离 (AD) 对照表

==管理距离（AD）用于衡量路由信息源的可信度。数值越小，优先级越高==

::: tip
在华为网络操作系统（VRP）中，该参数被称为 **Preference**；在思科（IOS）中被称为 **Administrative Distance (AD)**。
:::

| 路由来源 | 华为优先级 (Preference) | 思科管理距离 (AD) | 差异备注 |
| :--- | :---: | :---: | :--- |
| **直连路由 (Direct / Connected)** | **0** | **0** | 优先级最高 |
| **OSPF 内部路由 (Internal)** | **10** | **110** | 华为中 OSPF 极优 |
| **IS-IS** | **15** | **115** | - |
| **静态路由 (Static Route)** | **60** | **1** | **核心差异点** |
| **RIP / RIPng** | **100** | **120** | - |
| **OSPF ASE / NSSA (外部路由)** | **150** | **110** | 华为对外部路由进行了降级 |
| **外部 BGP (eBGP)** | **255** | **20** | 华为 BGP 默认优先级极低 |
| **内部 BGP (iBGP)** | **255** | **200** | 华为不区分内部/外部 BGP |
| **未知 (Unknown)** | **255** | **255** | 不可信路由 |

## 路由优先级 (Preference / AD) 调整命令对比

| 场景 | 华为 (VRP 平台) | 思科 (IOS 平台) |
| :--- | :--- | :--- |
| **静态路由** | `ip route-static 0.0.0.0 0 1.1.1.1 preference 100` | `ip route 0.0.0.0 0.0.0.0 1.1.1.1 100` |
| **OSPF 整体** | `ospf 1` <br> `preference 20` | `router ospf 1` <br> `distance 125` |
| **OSPF 外部** | `ospf 1` <br> `preference ase 160` | `router ospf 1` <br> `distance ospf external 150` |
| **RIP** | `rip 1` <br> `preference 150` | `router rip` <br> `distance 150` |
| **BGP** | `bgp 100` <br> `preference 20 200 200` | `router bgp 100` <br> `distance bgp 20 200 200` |

### 高级控制 (基于策略调整) 对比

| 厂商 | 配置逻辑 | 核心示例代码 |
| :--- | :--- | :--- |
| **华为** | **Route-Policy 挂载** | `ospf 1` <br> `preference route-policy PREF_NAME` |
| **思科** | **Distance + ACL** | `router ospf 1` <br> `distance 50 10.1.1.1 0.0.0.0 10` |

